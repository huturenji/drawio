<mxfile host="app.diagrams.net" modified="2022-04-26T02:12:30.202Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36" etag="M7600JG3KfBX_sy-PWcc" version="17.4.6" type="github">
  <diagram id="oIqPUORSx6AU8MDn17wn" name="商云授权流程(平台判断)">
    <mxGraphModel dx="1185" dy="635" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="aTw887wbx4HMRg9ZERxj-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="150" y="190" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-6" target="aTw887wbx4HMRg9ZERxj-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-6" value="进入商云应用" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="320" y="100" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-7" target="aTw887wbx4HMRg9ZERxj-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-7" target="aTw887wbx4HMRg9ZERxj-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-35" value="普通浏览器(browser)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="aTw887wbx4HMRg9ZERxj-29">
          <mxGeometry x="0.2636" relative="1" as="geometry">
            <mxPoint x="19" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-7" value="getPlatForm()平台判断（主要判断是否为普通浏览器）" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="330" y="230" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-12" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-9" target="aTw887wbx4HMRg9ZERxj-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-14" value="否" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-9" target="aTw887wbx4HMRg9ZERxj-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-9" value="是否bizmate" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="330" y="390" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-38" value="是（或者方法不存在，或者异常）" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-11" target="aTw887wbx4HMRg9ZERxj-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-11" target="aTw887wbx4HMRg9ZERxj-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-11" value="isLogin()核心方法是调用getuserstate方法判断用户是否登录" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="490" y="390" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-16" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-13" target="aTw887wbx4HMRg9ZERxj-17">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="690" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-37" value="否" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-13" target="aTw887wbx4HMRg9ZERxj-36">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-13" value="是否银企通（T信）tchat" style="rhombus;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="330" y="550" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-17" target="aTw887wbx4HMRg9ZERxj-18">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-17" value="默认银企通（T信）不存在游客方式，如有，则必须升级到bizmate" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.document2;whiteSpace=wrap;size=0.25;" vertex="1" parent="1">
          <mxGeometry x="320" y="710" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-24" value="成功" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-18" target="aTw887wbx4HMRg9ZERxj-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-18" target="aTw887wbx4HMRg9ZERxj-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-27" value="失败" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="aTw887wbx4HMRg9ZERxj-26">
          <mxGeometry x="0.1786" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-18" value="&lt;div&gt;调用授权方法进行授权（带有重试机制）&lt;/div&gt;&lt;div&gt;Auth(user)&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.1;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="320" y="850" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-23" value="以用户token访问商云资源" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="320" y="1090" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-25" value="触发警告或者提示" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="140" y="850" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-28" target="aTw887wbx4HMRg9ZERxj-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-28" value="&lt;div&gt;Auth(guest)&lt;/div&gt;&lt;div&gt;用游客访问商云资源&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="10" y="240" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-30" target="aTw887wbx4HMRg9ZERxj-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-30" value="&lt;div&gt;moduleGate()这个方法要拆分判断用户角色getRole()&amp;nbsp;&lt;/div&gt;&lt;div&gt;用户操作需要使用用户信息（例如下单）&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="10" y="360" width="100" height="120" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-32" target="aTw887wbx4HMRg9ZERxj-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-32" value="&lt;div&gt;Login(platform)&lt;/div&gt;&lt;div&gt;拉起登录页面，用户输入用户名密码登录&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="15" y="560" width="90" height="120" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-36" value="其他平台，按照平台特性处理" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="140" y="720" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-39" target="aTw887wbx4HMRg9ZERxj-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-39" value="&lt;div&gt;Auth(guest)&lt;/div&gt;&lt;div&gt;用游客访问商云资源&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="640" y="400" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-41" target="aTw887wbx4HMRg9ZERxj-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-41" value="&lt;div&gt;moduleGate()&lt;/div&gt;&lt;div&gt;这个方法要拆分判断用户角色getRole()&amp;nbsp;&amp;nbsp;&lt;/div&gt;&lt;div&gt;用户操作需要使用用户信息（例如下单）&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="640" y="500" width="100" height="120" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-46" value="是" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-43" target="aTw887wbx4HMRg9ZERxj-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-53" value="否" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-43" target="aTw887wbx4HMRg9ZERxj-52">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-43" value="&lt;div&gt;Login(platform)&lt;/div&gt;&lt;div&gt;是否存在jsbridge方法拉起登录页面&lt;/div&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="640" y="670" width="100" height="100" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-45" target="aTw887wbx4HMRg9ZERxj-47">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-45" value="h5调用jsbridge拉起app登录方法" style="whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="630" y="850" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-47" target="aTw887wbx4HMRg9ZERxj-49">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-47" value="App登录" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="640" y="970" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="aTw887wbx4HMRg9ZERxj-49" target="aTw887wbx4HMRg9ZERxj-18">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="910" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-49" value="&lt;div&gt;Logout()&lt;/div&gt;&lt;div&gt;调用登出方法，将guest登出&lt;/div&gt;" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=process;whiteSpace=wrap;rounded=1;size=0.14;arcSize=6;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="480" y="970" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-52" value="提示用户升级APP" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="720" y="1090" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-54" value="用isbridge或者url上渠道参数判断" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.document2;whiteSpace=wrap;size=0.25;" vertex="1" parent="1">
          <mxGeometry x="410" y="240" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="aTw887wbx4HMRg9ZERxj-55" value="后续都会升级为bizmate" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.document2;whiteSpace=wrap;size=0.25;" vertex="1" parent="1">
          <mxGeometry x="400" y="560" width="100" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
